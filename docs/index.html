<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>uuidx 0.8.0 documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
  var index_rel_prefix = "./";
</script>

<script src="./js/navigation.js" defer></script>
<script src="./js/search.js" defer></script>
<script src="./js/search_index.js" defer></script>
<script src="./js/searcher.js" defer></script>
<script src="./js/darkfish.js" defer></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">


<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>


    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  <div id="project-metadata">
    
<div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
    <li><a href="./CHANGELOG_md.html">CHANGELOG</a>
    <li><a href="./LICENSE_txt.html">LICENSE</a>
    <li><a href="./README_md.html">README</a>
  </ul>
</div>

    <div id="classindex-section" class="nav-section">
  <h3>Class and Module Index</h3>

  <ul class="link-list">
  <li><details open><summary><code><a href="./Uuid.html">Uuid</a></code></summary>
  <ul class="link-list">
  <li><code><a href="./Uuid/ClockResolutionError.html">ClockResolutionError</a></code>
  <li><code><a href="./Uuid/Error.html">Error</a></code>
  <li><code><a href="./Uuid/Version4.html">Version4</a></code>
  <li><code><a href="./Uuid/Version6.html">Version6</a></code>
  <li><code><a href="./Uuid/Version7.html">Version7</a></code>
  <li><code><a href="./Uuid/Version8.html">Version8</a></code>
  </ul></details>
</div>

  </div>
</nav>

<main role="main">

<h1 align="center">uuidx</h1><p align="center">Fast Ruby implementations of UUID versions 4, 6, 7, and 8 🪪</p><hr>

<h2 id="label-What-27s+in+the+box-3F">What’s in the box?<span><a href="#label-What-27s+in+the+box-3F">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>✅ Simple usage documentation written to get started fast. <a href="#usage">30 seconds and you’re off.</a></p>

<p>📚 API documentation for the library. <a href="https://tinychameleon.github.io/uuidx/">Read the docs.</a></p>

<p>⚡ A reasonably fast, zero dependency implementation of the new UUID standards.</p>

<p>🤖 RBS types for your type checking wants. <a href="./sig">Typed goodness.</a></p>

<p>💎 Tests against Ruby 2.7, 3.0, 3.1, and 3.2.</p>

<p>🔒 MFA protection on gem owners.</p>
<hr>

<h2 id="label-Installation">Installation<span><a href="#label-Installation">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-Using+Bundler">Using Bundler<span><a href="#label-Using+Bundler">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Run <code>bundle add uuidx</code> to update your <code>Gemfile</code> and install the gem. You may also add the gem to your <code>Gemfile</code> manually and then run <code>bundle install</code>.</p>

<h3 id="label-Manual">Manual<span><a href="#label-Manual">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Use <code>gem install uuidx</code> to install the gem from <a href="https://rubygems.org">RubyGems</a>.</p>

<h2 id="label-Usage">Usage<span><a href="#label-Usage">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>To get started using the default generators for UUID v4, v6, or v7 <code>require</code> the library and call the associated method.</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&quot;uuidx&quot;</span>

<span class="ruby-constant">Uuid</span>.<span class="ruby-identifier">v4</span> <span class="ruby-comment"># =&gt; &quot;2b54639d-e43e-489f-9c64-30ecdcac3c95&quot;</span>
<span class="ruby-constant">Uuid</span>.<span class="ruby-identifier">v6</span> <span class="ruby-comment"># =&gt; &quot;1eda9761-9f6f-6414-8c5f-fd61f1239907&quot;</span>
<span class="ruby-constant">Uuid</span>.<span class="ruby-identifier">v7</span> <span class="ruby-comment"># =&gt; &quot;01863d24-6d1e-78ba-92ee-6e80c79c4e28&quot;</span>
</pre>

<p>These methods all use default generators and are thread-safe. However, if you are using child processes (like Puma’s clustered mode) you should also reset the generators you are using when each child process starts.</p>

<pre class="ruby"><span class="ruby-comment"># Puma example that resets all default generators.</span>
<span class="ruby-identifier">on_worker_boot</span> <span class="ruby-keyword">do</span>
  <span class="ruby-constant">Uuid</span>.<span class="ruby-identifier">reset_v4!</span>
  <span class="ruby-constant">Uuid</span>.<span class="ruby-identifier">reset_v6!</span>
  <span class="ruby-constant">Uuid</span>.<span class="ruby-identifier">reset_v7!</span>
<span class="ruby-keyword">end</span>
</pre>

<p>This way you will get thread-safe state access per process without requiring IPC.</p>

<h3 id="label-Advanced+Usage">Advanced Usage<span><a href="#label-Advanced+Usage">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>If you require multiple generators you can drop below the simple API presented above to create generators directly.</p>

<pre class="ruby"><span class="ruby-identifier">v6</span> = <span class="ruby-constant">Uuid</span><span class="ruby-operator">::</span><span class="ruby-constant">Version6</span>.<span class="ruby-identifier">new</span>
<span class="ruby-identifier">v6</span>.<span class="ruby-identifier">generate</span> <span class="ruby-comment"># =&gt; &quot;1eda9adc-2ed9-629e-9a02-4d2ccc87c569&quot;</span>
</pre>

<p>These generators are lock-free, so if you use them to obtain higher throughput keep in mind that you must ensure they are never shared between threads.</p>

<p>For typical MRI Ruby workloads using multi-process worker strategies state will be cloned and modified using copy-on-write and the thread safety provided by the simple API is adequate.</p>

<h4 id="label-UUID+v8">UUID v8<span><a href="#label-UUID+v8">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>UUID v8 is a special case of advanced usage that always requires you to build a generator directly. It takes a single parameter to its constructor which must be the class name of your UUID v8 definition.</p>

<pre class="ruby"><span class="ruby-identifier">v8</span> = <span class="ruby-constant">Uuid</span><span class="ruby-operator">::</span><span class="ruby-constant">Version8</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">MyV8Definition</span>)
<span class="ruby-identifier">v8</span>.<span class="ruby-identifier">generate</span> <span class="ruby-comment"># =&gt; &quot;...&quot;</span>
</pre>

<p>The definition class should implement the methods <code>custom_a</code>, <code>custom_b</code>, and <code>custom_c</code> in order to fill out the UUID data <a href="https://www.ietf.org/archive/id/draft-ietf-uuidrev-rfc4122bis-01.html#name-uuid-version-8">according to the draft</a>.</p>

<p>See the <a href="https://tinychameleon.github.io/uuidx/Uuid/Version8.html">documentation for Version8</a> for precise details.</p>

<h3 id="label-Clock+Resolution">Clock Resolution<span><a href="#label-Clock+Resolution">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>If you have need to verify the clock resolution for UUID v6 or v7 you can call the <code>verify_clock_resolution!</code> method on either class. A <code>ClockResolutionError</code> is raised if the system has insufficient precision.</p>

<pre class="ruby"><span class="ruby-keyword">begin</span>
  <span class="ruby-constant">Uuid</span><span class="ruby-operator">::</span><span class="ruby-constant">Version6</span>.<span class="ruby-identifier">verify_clock_resolution!</span> <span class="ruby-comment"># or Uuid::Version7</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">Uuid</span><span class="ruby-operator">::</span><span class="ruby-constant">ClockResolutionError</span>
  <span class="ruby-comment"># ...</span>
<span class="ruby-keyword">end</span>
</pre>

<p>The API documentation has details about what the clock resolution must be for each of the UUID versions. See the <a href="https://tinychameleon.github.io/uuidx/Uuid/Version6.html">Version 6</a> and <a href="https://tinychameleon.github.io/uuidx/Uuid/Version7.html">Version 7</a> documentation for details.</p>

<h3 id="label-A+Note+on+Clock+Timings">A Note on Clock Timings<span><a href="#label-A+Note+on+Clock+Timings">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The API documentation contains specific details around how the implementations deal with clock drift. See the <a href="https://tinychameleon.github.io/uuidx/Uuid.html">Uuid</a>, <a href="https://tinychameleon.github.io/uuidx/Uuid/Version6.html">Version 6</a>, and <a href="https://tinychameleon.github.io/uuidx/Uuid/Version7.html">Version 7</a> documentation for more information.</p>

<h2 id="label-Performance">Performance<span><a href="#label-Performance">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>This performance data was captured using <code>benchmark/ips</code>. It uses the following Ruby version</p>

<pre>ruby 3.2.0 (2022-12-25 revision a528908271) [arm64-darwin22]</pre>

<p>and is run on a Macbook Pro with an M1 Max CPU.</p>

<pre>❯ bundle exec ruby test/benchmarks/simple_api.rb
Warming up --------------------------------------
              stdlib    62.055k i/100ms
               uuid4   108.502k i/100ms
               uuid6   114.782k i/100ms
               uuid7   104.576k i/100ms
Calculating -------------------------------------
              stdlib    628.493k (± 0.2%) i/s -      3.165M in   5.035575s
               uuid4      1.084M (± 1.1%) i/s -      5.425M in   5.005244s
               uuid6      1.149M (± 0.2%) i/s -      5.854M in   5.096869s
               uuid7      1.052M (± 0.8%) i/s -      5.333M in   5.071797s

Comparison:
               uuid6:  1148528.3 i/s
               uuid4:  1084023.7 i/s - 1.06x  (± 0.00) slower
               uuid7:  1051645.3 i/s - 1.09x  (± 0.00) slower
              stdlib:   628492.6 i/s - 1.83x  (± 0.00) slower</pre>

<p>As reported, the <code>stdlib</code> version of <code>SecureRandom.uuid</code> is at least 1.70x slower than the simple API implementation of UUID v4.</p>

<p>These timings are good enough that they shouldn’t get in the way of any web frameworks.</p>

<h2 id="label-Development">Development<span><a href="#label-Development">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>After checking out the repo, run <code>bin/setup</code> to install dependencies. Then, run <code>rake test</code> to run the tests. You can also run <code>bin/console</code> for an interactive prompt that will allow you to experiment.</p>

<p>To run tests across all supported Ruby versions on Debian and Alpine Linux run <code>make test-all</code>. To run a specific version use <code>make test-[version]</code>; for example, <code>make test-3.2.0</code>.</p>

<p>To install this gem onto your local machine, run <code>bundle exec rake install</code>.</p>

<p>To release a new version:</p>
<ol><li>
<p>ensure the documentation and changelog are ready</p>
</li><li>
<p>run <code>bundle exec rake rdoc</code> to generate the new documentation and commit it</p>
</li><li>
<p>update the version number in <code>lib/uuid/gem_version.rb</code></p>
</li><li>
<p>run <code>bundle install</code> to update the <code>Gemfile.lock</code></p>
</li><li>
<p>create a release commit with the version updates</p>
</li><li>
<p>run <code>bundle exec rake release</code> to tag and push the version to RubyGems</p>
</li></ol>

<h2 id="label-Contributing">Contributing<span><a href="#label-Contributing">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Bug reports and pull requests are welcome on GitHub at <a href="https://github.com/tinychameleon/uuidx">github.com/tinychameleon/uuidx</a>.</p>

<h2 id="label-License">License<span><a href="#label-License">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>The gem is available as open source under the terms of the <a href="https://opensource.org/licenses/MIT">MIT License</a>.</p>

</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.5.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

